version: '3.8'
services:

  #
  # Deploy Elasticsearch
  #
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.3.2
    hostname: elastic-internal.authsamples-dev.com
    ports:
      - 9200:9200
    volumes:
      - ./certs/authsamples-dev.ca.pem:/usr/share/elasticsearch/config/certs/authsamples-dev.ca.crt
      - ./certs/authsamples-dev.ssl.p12:/usr/share/elasticsearch/config/certs/authsamples-dev.ssl.p12
    environment:
      discovery.type: 'single-node'
      xpack.security.enabled: 'true'
      xpack.security.http.ssl.enabled: 'true'
      xpack.security.http.ssl.keystore.path: '/usr/share/elasticsearch/config/certs/authsamples-dev.ssl.p12'
      xpack.security.http.ssl.keystore.password: 'Password1'
      xpack.security.http.ssl.certificate_authorities: '/usr/share/elasticsearch/config/certs/authsamples-dev.ca.crt'
      ELASTIC_PASSWORD: 'Password1'

  #kibana:
  #  image: docker.elastic.co/kibana/kibana:8.3.2
  #  hostname: kibana-internal.authsamples-dev.com
  #  ports:
  #    - 5600:5600

  #filebeat:
  #  image: docker.elastic.co/beats/filebeat:8.3.2
  #  hostname: filebeat-internal.authsamples-dev.com
  #  extra_hosts:
  #   - api.authsamples-dev.com:host-gateway
